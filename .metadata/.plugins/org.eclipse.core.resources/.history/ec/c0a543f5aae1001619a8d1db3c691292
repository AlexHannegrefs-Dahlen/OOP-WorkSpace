package tic.tac.toe.controller;

import java.io.IOException;

import tic.tac.toe.model.board.Board;
import tic.tac.toe.model.player.OPlayer;
import tic.tac.toe.model.player.Player;
import tic.tac.toe.model.player.XPlayer;
import tic.tac.toe.view.Viewer;
import tic.tac.toe.model.player.Player.XO;

public class Tic_Tac_Toe {
	private Player playerX;
	private Player playerO;
	private Board gameBoard;

	private char O = 'O';
	private char X = 'X';

	public void run() throws IOException {
		gameBoard = new Board();
		playerX = new XPlayer(XO.X, true);
		playerO = new OPlayer(XO.O, false);
		boolean gameQuit = false;
		while (!gameQuit) {
			Viewer.printBoard();
			if (playerX.isTurn()) {
				Viewer.displayStringToUser("Player X's turn");
				takeSquareUserSelected(Viewer.getSquareSelection());
			} else {
				Viewer.displayStringToUser("Player O's turn");
				takeSquareUserSelected(Viewer.getSquareSelection());
			}
			switchTurns();
		}
	}

	private void takeSquareUserSelected(int userSelection) {
		if (playerX.isTurn())
			Board.getBoardspaces()[userSelection - 1].setSymbol(X);
		else
			Board.getBoardspaces()[userSelection - 1].setSymbol(O);
		Board.getBoardspaces()[userSelection - 1].setTaken(true);
	}

	private void switchTurns() {
		playerO.setTurn(!playerO.isTurn());
		playerX.setTurn(!playerX.isTurn());
	}

	public Board getGameBoard() {
		return gameBoard;
	}
}
